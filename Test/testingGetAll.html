<body>
	<div>
		<button onclick="getAll('mongodb')">FETCH MONGODB</button>
		<button onclick="getAll('couchbase')">FETCH COUHBASE</button>
	</div>
	<script>
		function fetchingAll(uri, db) {
			let end;
			const div = document.querySelector("div");
			let start = performance.now();
			fetch(`${uri}`, {
				method: "GET",
				mode: "cors",
				cache: "default",
			})
				.then((response) => {
					return response.json();
				})
				.then((data) => {
					const stringified = JSON.stringify(data);
					div.innerHTML = stringified;
				})
				.then(() => {
					end = performance.now();
					const result = end - start;

					if (localStorage.getItem(db)) {
						let allYears = localStorage.getItem(db).split();
						allYears.push(result);
						allYears.toString();
						localStorage.setItem(db, allYears);
					} else {
						localStorage.setItem(db, result);
					}
				});
		}

		function getAll(database) {
			const getAllLoops = 500;
			for (let i = 0; i < getAllLoops; i++) {
				setTimeout(function() {
					fetchingPopulation(
						`http://192.168.1.32:3000/${database}/population/`,
						`${database}Population`
					);
					if (i === getAllLoops - 1) {
						console.log("DONE");
					}
				}, 500 * i);
			}
		}
	</script>
</body>
